# VectorFloatAdder 功能点与检测点描述

## DUT 整体功能描述

VectorFloatAdder是一个向量浮点加法器，支持多种浮点格式（半精度f16、单精度f32、双精度f64）的加法和减法运算，并支持精度转换、归约操作和折叠操作等高级功能。该设计采用两周期流水线结构，支持向量并行计算，能够根据fp_format信号在同一周期内执行1个f64、2个f32或4个f16运算。

### 端口接口说明

**输入端口：**
- `io_fire`：开始计算信号，1位
- `io_fp_a`：输入操作数a，64位
- `io_fp_b`：输入操作数b，64位
- `io_round_mode`：舍入模式，3位，支持5种IEEE754舍入模式
- `io_fp_format`：浮点格式，2位，00=f16，01=f32，10=f64
- `io_op_code`：操作码，5位，定义具体运算类型
- 其他控制信号：包括扩展操作数、掩码、归约控制等

**输出端口：**
- `io_fp_result`：运算结果，64位，根据格式包含不同数量的结果
- `io_fflags`：标志位，20位，包含异常和状态信息

## 功能分组与检测点

### DUT测试API

<FG-API>

#### 通用运算接口

<FC-OPERATION>

提供VectorFloatAdder支持的各种运算操作接口，涵盖所有op操作码对应的运算类型。这些操作是DUT的核心功能实现，支持多种浮点格式和向量并行计算。

**检测点：**
- <CK-FADD> 浮点加法操作：验证op=0b00000时的浮点加法运算功能
- <CK-FSUB> 浮点减法操作：验证op=0b00001时的浮点减法运算功能
- <CK-FMIN> 最小值操作：验证op=0b00010时的浮点最小值运算功能
- <CK-FMAX> 最大值操作：验证op=0b00011时的浮点最大值运算功能
- <CK-FMERGE> 条件选择操作：验证op=0b00100时的条件选择运算功能
- <CK-FMOVE> 数据移动操作：验证op=0b00101时的数据移动功能
- <CK-FSGNJ> 符号注入操作：验证op=0b00110时的符号注入功能
- <CK-FSGNJN> 符号注入取反操作：验证op=0b00111时的符号注入取反功能
- <CK-FSGNJX> 符号注入异或操作：验证op=0b01000时的符号注入异或功能
- <CK-FEQ> 相等比较操作：验证op=0b01001时的浮点相等比较功能
- <CK-FNE> 不等比较操作：验证op=0b01010时的浮点不等比较功能
- <CK-FLT> 小于比较操作：验证op=0b01011时的浮点小于比较功能
- <CK-FLE> 小于等于比较操作：验证op=0b01100时的浮点小于等于比较功能
- <CK-FGT> 大于比较操作：验证op=0b01101时的浮点大于比较功能
- <CK-FGE> 大于等于比较操作：验证op=0b01110时的浮点大于等于比较功能
- <CK-FCLASS> 浮点分类操作：验证op=0b01111时的浮点数值分类功能
- <CK-FMV-F-S> 标量到向量移动：验证op=0b10001时的标量浮点移动到向量功能
- <CK-FMV-S-F> 向量到标量移动：验证op=0b10010时的向量移动到标量浮点功能
- <CK-FMIN-RE> 有序最小值：验证op=0b10100时的有序向量浮点最小值功能
- <CK-FMAX-RE> 有序最大值：验证op=0b10101时的有序向量浮点最大值功能
- <CK-FSUM-ORE> 有序求和：验证op=0b10110时的有序向量浮点求和功能
- <CK-FMAXM> 带掩码最大值：验证op=0b10011时的有序向量浮点最大值功能
- <CK-FLEQ> 安静版本小于等于：验证op=0b11100时的安静版本浮点小于等于比较
- <CK-FLTQ> 安静版本小于：验证op=0b11011时的安静版本浮点小于比较
- <CK-FSUM-URE> 无约束求和：验证op=0b11010时的无约束向量浮点求和功能
- <CK-FMINM> 带掩码最小值：验证op=0b11110时的有序向量浮点最小值功能
- <CK-DUMMY> 空操作：验证op=0b11111时的空操作或占位符功能

### 基础算术运算

<FG-ARITHMETIC>

包含基本的浮点算术运算功能：加法、减法、求和等。这些是VectorFloatAdder的核心运算功能，支持多种精度格式和向量并行计算。

#### 浮点加法功能

<FC-FADD>

实现浮点加法运算，支持f16、f32、f64三种格式，能够进行单精度或多精度并行计算。运算公式：result = a + b

**检测点：**
- <CK-BASIC> 基本加法：验证正常数值的加法运算，如1.0 + 2.0 = 3.0
- <CK-VECTOR-PARALLEL> 向量并行：验证同一周期内多个并行加法运算的正确性
- <CK-MIXED-PRECISION> 混合精度：验证不同精度格式间的加法运算
- <CK-ROUNDING> 舍入处理：验证不同舍入模式下的加法结果
- <CK-FLAGS> 标志位生成：验证加法运算产生的异常标志位

#### 浮点减法功能

<FC-FSUB>

实现浮点减法运算，支持多种精度格式和向量并行计算。运算公式：result = a - b

**检测点：**
- <CK-BASIC> 基本减法：验证正常数值的减法运算，如5.0 - 3.0 = 2.0
- <CK-VECTOR-PARALLEL> 向量并行：验证同一周期内多个并行减法运算的正确性
- <CK-MIXED-PRECISION> 混合精度：验证不同精度格式间的减法运算
- <CK-ROUNDING> 舍入处理：验证不同舍入模式下的减法结果
- <CK-FLAGS> 标志位生成：验证减法运算产生的异常标志位

#### 向量求和功能

<FC-VECTOR-SUM>

实现向量浮点数的求和运算，包括无约束求和和有序求和两种模式。

**检测点：**
- <CK-UNCONSTRAINED> 无约束求和：验证fsum_ure操作的无约束向量浮点求和
- <CK-ORDERED> 有序求和：验证fsum_ore操作的有序向量浮点求和
- <CK-PRECISION> 精度处理：验证求和过程中的精度保持和舍入
- <CK-OVERFLOW> 溢出处理：验证求和过程中的溢出检测和处理

### 比较运算

<FG-COMPARISON>

包含各种浮点数比较运算功能，支持常规比较和安静版本比较。

#### 基本比较功能

<FC-BASIC-CMP>

实现基本的浮点数比较运算，包括相等、不等、大小比较等。

**检测点：**
- <CK-EQUAL> 相等比较：验证feq操作的浮点数相等比较功能
- <CK-NOT-EQUAL> 不等比较：验证fne操作的浮点数不等比较功能
- <CK-LESS> 小于比较：验证flt操作的浮点数小于比较功能
- <CK-LESS-EQUAL> 小于等于：验证fle操作的浮点数小于等于比较功能
- <CK-GREATER> 大于比较：验证fgt操作的浮点数大于比较功能
- <CK-GREATER-EQUAL> 大于等于：验证fge操作的浮点数大于等于比较功能

#### 安静版本比较

<FC-QUIET-CMP>

实现安静版本的浮点比较运算，不产生异常标志。

**检测点：**
- <CK-QUIET-LE> 安静小于等于：验证fleq操作的安静版本比较功能
- <CK-QUIET-LT> 安静小于：验证fltq操作的安静版本比较功能
- <CK-NO-FLAGS> 无标志生成：验证安静版本比较不产生异常标志

### 极值运算

<FG-EXTREME>

包含浮点数的最大值、最小值运算功能，支持常规和有序版本。

#### 极值查找功能

<FC-EXTREME-FIND>

实现浮点数的最大值和最小值查找功能。

**检测点：**
- <CK-MIN> 最小值查找：验证fmin操作的最小值查找功能
- <CK-MAX> 最大值查找：验证fmax操作的最大值查找功能
- <CK-SPECIAL> 特殊值处理：验证NaN、无穷大等特殊值的极值处理
- <CK-ORDERED> 有序极值：验证fmin_re、fmax_re的有序极值功能
- <CK-MASKED> 带掩码极值：验证fminm、fmaxm的带掩码极值功能

### 数据操作

<FG-DATA-OP>

包含数据移动、选择、符号操作等功能。

#### 数据移动功能

<FC-DATA-MOVE>

实现数据的移动和传输功能。

**检测点：**
- <CK-MERGE> 数据合并：验证fmerge操作的条件数据合并功能
- <CK-MOVE> 数据移动：验证fmove操作的数据移动功能
- <CK-SCALAR-TO-VECTOR> 标量到向量：验证fmv_f_s操作的标量到向量移动
- <CK-VECTOR-TO-SCALAR> 向量到标量：验证fmv_s_f操作的向量到标量移动

#### 符号操作功能

<FC-SIGN-OP>

实现浮点数的符号操作功能。

**检测点：**
- <CK-SIGN-INJECT> 符号注入：验证fsgnj操作的符号注入功能
- <CK-SIGN-INJECT-NOT> 符号注入取反：验证fsgnjn操作的符号注入取反功能
- <CK-SIGN-INJECT-XOR> 符号注入异或：验证fsgnjx操作的符号注入异或功能

### 特殊功能

<FG-SPECIAL>

包含浮点数分类和其他特殊功能。

#### 浮点分类功能

<FC-FLOAT-CLASS>

实现浮点数的分类功能，能够识别浮点数的类型和特征。

**检测点：**
- <CK-CLASSIFY> 数值分类：验证fclass操作的浮点数分类功能
- <CK-SPECIAL-TYPES> 特殊类型识别：验证NaN、无穷大、零等特殊类型的识别
- <CK-NORMAL-TYPES> 常规类型识别：验证常规浮点数的类型识别

### 格式与精度

<FG-FORMAT-PRECISION>

包含不同浮点格式和精度的处理功能。

#### 多精度支持

<FC-MULTI-PRECISION>

支持f16、f32、f64多种浮点格式的运算。

**检测点：**
- <CK-F16> 半精度格式：验证f16格式下的运算功能
- <CK-F32> 单精度格式：验证f32格式下的运算功能
- <CK-F64> 双精度格式：验证f64格式下的运算功能
- <CK-PARALLEL> 并行计算：验证同周期内多个并行运算的正确性

#### 混合精度运算

<FC-MIXED-PRECISION>

支持不同精度格式间的混合运算。

**检测点：**
- <CK-F64-F32> 双精度-单精度：验证f64=f64+f32的混合精度运算
- <CK-F32-F16> 单精度-半精度：验证f32=f32+f16的混合精度运算
- <CK-CONVERSION> 精度转换：验证格式转换过程中的精度保持

### 舍入与异常

<FG-ROUNDING-EXCEPTION>

包含舍入模式处理和异常检测功能。

#### 舍入模式

<FC-ROUNDING-MODE>

支持IEEE754标准的5种舍入模式。

**检测点：**
- <CK-RNE> 最近偶数舍入：验证RNE舍入模式的正确性
- <CK-RTZ> 向零舍入：验证RTZ舍入模式的正确性
- <CK-RDN> 向下舍入：验证RDN舍入模式的正确性
- <CK-RUP> 向上舍入：验证RUP舍入模式的正确性
- <CK-RMM> 最近最大值舍入：验证RMM舍入模式的正确性

#### 异常处理

<FC-EXCEPTION-HANDLE>

实现IEEE754标准的异常检测和处理。

**检测点：**
- <CK-INVALID-OP> 无效操作：验证无效操作异常的检测和标志生成
- <CK-OVERFLOW> 上溢处理：验证上溢异常的检测和标志生成
- <CK-UNDERFLOW> 下溢处理：验证下溢异常的检测和标志生成
- <CK-INEXACT> 不精确运算：验证不精确运算的检测和标志生成
- <CK-SPECIAL-VALUES> 特殊值处理：验证NaN、无穷大等特殊值的处理

### 特殊值处理

<FG-SPECIAL-VALUES>

包含各种特殊浮点值的处理功能。

#### NaN值处理

<FC-NAN-HANDLE>

实现NaN（Not a Number）值的处理和传播。

**检测点：**
- <CK-NAN-INPUT> NaN输入：验证输入为NaN时的处理
- <CK-NAN-PROPAGATION> NaN传播：验证NaN值的传播规则
- <CK-CANONICAL-NAN> 规范NaN：验证规范NaN的处理
- <CK-QUIET-NAN> 安静NaN：验证安静NaN的处理

#### 无穷大处理

<FC-INF-HANDLE>

实现无穷大值的运算和处理。

**检测点：**
- <CK-INF-INPUT> 无穷大输入：验证输入为无穷大时的处理
- <CK-INF-ARITHMETIC> 无穷大运算：验证包含无穷大的运算结果
- <CK-INF-SIGN> 无穷大符号：验证正负无穷大的符号处理

#### 零值处理

<FC-ZERO-HANDLE>

实现零值的运算和处理。

**检测点：**
- <CK-ZERO-INPUT> 零值输入：验证输入为零时的处理
- <CK-SIGNED-ZERO> 有符号零：验证+0和-0的区别处理
- <CK-ZERO-ARITHMETIC> 零值运算：验证包含零的运算结果

### 向量与掩码

<FG-VECTOR-MASK>

包含向量运算和掩码控制功能。

#### 向量控制

<FC-VECTOR-CTRL>

实现向量运算的控制功能。

**检测点：**
- <CK-VECTOR-MODE> 向量模式：验证向量模式的控制功能
- <CK-MASK-CONTROL> 掩码控制：验证掩码对向量运算的控制
- <CK-PARALLEL-EXEC> 并行执行：验证向量并行执行的正确性

#### 归约操作

<FC-REDUCTION>

实现向量的归约操作功能。

**检测点：**
- <CK-REDUCTION-MASK> 归约掩码：验证归约操作的掩码控制
- <CK-REDUCTION-ORDER> 归约顺序：验证有序和无约束归约的区别
- <CK-REDUCTION-FOLD> 归约折叠：验证归约操作的折叠功能