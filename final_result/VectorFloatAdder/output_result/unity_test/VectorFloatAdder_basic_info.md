# VectorFloatAdder 基础信息

## 芯片概述
VectorFloatAdder是一个向量浮点加法器，支持多种浮点格式（半精度f16、单精度f32、双精度f64）的加法和减法运算，并支持精度转换、归约操作和折叠操作等高级功能。

## 芯片类型
VectorFloatAdder是一个**时序电路**，具有以下特征：
- 包含时钟信号（clock）和复位信号（reset）
- 内部使用流水线设计（Pipeline），包括FloatAdderF32WidenF16MixedPipeline等模块
- 采用两周期流水线设计以提升吞吐率

## 输入输出端口分析

### 通用引脚
|端口名称|位宽|方向|功能描述|
|--------|------|------|---------|
|clock|1位|输入|时钟信号，驱动时序电路|
|reset|1位|输入|复位信号，用于初始化电路状态|

### 输入引脚
|端口名称|位宽|方向|功能描述|
|--------|------|------|---------|
|io_fire|1位|输入|开始计算信号，控制运算启动|
|io_fp_a|64位|输入|输入操作数a，包含浮点数据|
|io_fp_b|64位|输入|输入操作数b，包含浮点数据|
|io_widen_a|64位|输入|扩展操作数a（测试中置0）|
|io_widen_b|64位|输入|扩展操作数b（测试中置0）|
|io_frs1|64位|输入|备用操作数（测试中置0）|
|io_is_frs1|1位|输入|是否使用frs1操作数（测试中置0）|
|io_mask|4位|输入|掩码信号（测试中置0）|
|io_uop_idx|1位|输入|微操作索引（测试中置0）|
|io_is_vec|1位|输入|向量模式标志（测试中置1）|
|io_round_mode|3位|输入|舍入模式，支持5种IEEE754舍入模式|
|io_fp_format|2位|输入|浮点格式选择：00=f16，01=f32，10=f64|
|io_opb_widening|1位|输入|源操作数vs1是否与结果格式相同|
|io_res_widening|1位|输入|指示是否为widen指令（结果格式加宽）|
|io_op_code|5位|输入|操作码，定义具体运算类型|
|io_fp_aIsFpCanonicalNAN|1位|输入|a是否为规范NaN（测试中置0）|
|io_fp_bIsFpCanonicalNAN|1位|输入|b是否为规范NaN（测试中置0）|
|io_maskForReduction|8位|输入|归约操作掩码（测试中置0）|
|io_is_vfwredosum|1位|输入|归约操作标志（测试中置0）|
|io_is_fold|3位|输入|折叠操作标志（测试中置0）|
|io_vs2_fold|128位|输入|折叠操作数据源（测试中置0）|

### 输出引脚
|端口名称|位宽|方向|功能描述|
|--------|------|------|---------|
|io_fp_result|64位|输出|运算结果，根据格式包含1个f64、2个f32或4个f16结果|
|io_fflags|20位|输出|标志位，每5位为一个向量的5个标志：无效操作、被零除、上溢、下溢、不精确|

## 功能分类

VectorFloatAdder的功能可以分为以下几大类：

### 1. 基本算术运算（约8个功能点）
- 加法运算（fadd）
- 减法运算（fsub）
- 无约束求和（fsum_ure）
- 有序求和（fsum_ore）

### 2. 比较运算（约10个功能点）
- 相等比较（feq）
- 不等比较（fne）
- 小于比较（flt）
- 小于等于比较（fle）
- 大于比较（fgt）
- 大于等于比较（fge）
- 安静版本比较（fleq, fltq）

### 3. 极值运算（约6个功能点）
- 最小值运算（fmin）
- 最大值运算（fmax）
- 有序最小值（fmin_re）
- 有序最大值（fmax_re）
- 带掩码最小值（fminm）
- 带掩码最大值（fmaxm）

### 4. 数据移动和选择（约6个功能点）
- 数据合并（fmerge）
- 数据移动（fmove）
- 标量到向量移动（fmv_f_s）
- 向量到标量移动（fmv_s_f）
- 符号注入（fsgnj）
- 符号注入取反（fsgnjn）
- 符号注入异或（fsgnjx）

### 5. 特殊功能（约2个功能点）
- 浮点数值分类（fclass）
- 空操作（dummy）

## 总计功能点
VectorFloatAdder总共包含约**32个主要功能点**，每个功能点都需要在不同浮点格式、不同舍入模式下进行验证，总计需要验证的功能组合超过数百种。

## 关键特性
1. **并行计算**：根据fp_format支持1-4个并行运算
2. **混合精度**：支持不同精度格式间的运算
3. **流水线设计**：采用两周期流水线提升性能
4. **异常处理**：完整的IEEE754异常处理机制
5. **向量支持**：完整的向量运算支持

## 测试注意事项
1. 测试过程中有部分引脚需要置为固定值
2. 必须使用Step接口驱动电路（时序电路要求）
3. 需要考虑流水线延迟对结果的影响
4. 标志位fflags的有效位数随格式变化