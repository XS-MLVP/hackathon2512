# VectorIdiv 基础信息文档

## 1. 芯片概述

VectorIdiv是一个向量整数除法器，支持多种位宽的整数除法运算，采用SRT-4算法实现。该模块遵循RISC-V标准标量整数乘除法规范，能够并行处理多个除法运算，支持有符号和无符号除法操作。

## 2. 接口分析

### 2.1 输入端口详细分析

| 端口名称 | 位宽 | 方向 | 功能描述 |
|---------|------|------|---------|
| `clock` | 1 | Input | 时钟信号，驱动时序电路 |
| `reset` | 1 | Input | 复位信号，用于初始化电路状态 |
| `io_sew` | 2 | Input | 元素宽度选择（SEW），控制操作数位宽：<br>00=8位，01=16位，10=32位，11=64位 |
| `io_sign` | 1 | Input | 符号位选择：0=无符号除法，1=有符号除法 |
| `io_dividend_v` | 128 | Input | 被除数向量，包含多个待除元素 |
| `io_divisor_v` | 128 | Input | 除数向量，包含多个除数元素 |
| `io_flush` | 1 | Input | 刷新操作信号，用于清除流水线中的操作 |
| `io_div_in_valid` | 1 | Input | 输入数据有效信号，表示输入数据准备就绪 |
| `io_div_out_ready` | 1 | Input | 输出数据准备好接收信号，表示下游准备好接收结果 |

### 2.2 输出端口详细分析

| 端口名称 | 位宽 | 方向 | 功能描述 |
|---------|------|------|---------|
| `io_d_zero` | 16 | Output | 除零标志向量，每个bit对应一个元素的除零状态 |
| `io_div_in_ready` | 1 | Output | 输入数据准备好接收信号，表示模块准备好接收新数据 |
| `io_div_out_valid` | 1 | Output | 输出数据有效信号，表示输出结果有效 |
| `io_div_out_q_v` | 128 | Output | 商向量，包含各元素的除法商结果 |
| `io_div_out_rem_v` | 128 | Output | 余数向量，包含各元素的除法余数结果 |

### 2.3 端口分组结构

根据代码分析，端口具有以下层次结构：
- `io`: 顶层I/O分组
- `io_div`: 除法相关信号分组
- `io_div_in`: 输入控制信号分组
- `io_div_out`: 输出控制信号分组

## 3. 电路类型分析

VectorIdiv是一个**时序电路**，依据如下：

1. **时钟信号存在**：模块包含`clock`输入信号，用于同步时序操作
2. **流水线架构**：文档明确说明采用多级流水线提高吞吐率
3. **握手协议**：使用valid/ready握手协议进行数据传输控制
4. **SRT-4算法**：该算法需要多轮迭代，必须在时序电路中实现

## 4. 功能分类分析

### 4.1 核心功能大类

基于分析和规范文档，VectorIdiv的功能可分为以下5大类：

#### 4.1.1 基础除法运算功能
- 有符号整数除法运算
- 无符号整数除法运算
- 商和余数同时计算
- 向零取整运算规则

#### 4.1.2 多精度支持功能
- 8位整数除法（SEW=00）
- 16位整数除法（SEW=01）
- 32位整数除法（SEW=10）
- 64位整数除法（SEW=11）

#### 4.1.3 向量化处理功能
- 并行多元素除法运算
- 向量数据打包/解包
- 元素间独立性保证
- 混合数据处理

#### 4.1.4 边界条件处理功能
- 除零检测和处理
- 有符号除法溢出处理
- 最小值/最大值运算
- 特殊值边界处理

#### 4.1.5 流水线控制功能
- 输入数据流控制
- 输出数据流控制
- 刷新操作处理
- 反压机制

### 4.2 具体功能点统计

总计约**25-30个**主要功能点：

**基础除法运算功能（6-8个功能点）：**
- 有符号除法基本运算
- 无符号除法基本运算
- 商计算正确性
- 余数计算正确性
- 向零取整规则实现
- 除法恒等式验证（被除数=除数×商+余数）

**多精度支持功能（8个功能点）：**
- 8位有符号除法
- 8位无符号除法
- 16位有符号除法
- 16位无符号除法
- 32位有符号除法
- 32位无符号除法
- 64位有符号除法
- 64位无符号除法

**向量化处理功能（4-6个功能点）：**
- 单元素向量运算
- 多元素并行运算
- 元素独立性验证
- 向量数据正确解析
- 部分元素无效处理

**边界条件处理功能（4-5个功能点）：**
- 除零检测（标志设置）
- 除零结果处理（商=全1，余数=被除数）
- 有符号溢出检测（-2^(L-1)/-1）
- 溢出结果处理（商=被除数，余数=0）
- 边界值运算验证

**流水线控制功能（3-4个功能点）：**
- 握手协议实现
- 刷新操作功能
- 流水线数据流控制
- 反压处理机制

## 5. 关键特性

### 5.1 SRT-4算法特性
- 每迭代一次产生2位商
- 需要查表操作确定商数字
- 具有收敛性和稳定性

### 5.2 RISC-V兼容性
- 完全兼容RISC-V除法指令规范
- 支持DIV、DIVU、REM、REMU指令语义
- 支持RV64的DIVW、DIVUW、REMW、REMUW指令

### 5.3 错误处理机制
- 完善的除零检测
- 有符号溢出保护
- 异常状态标志输出

## 6. 性能指标

- **并行度**：最多支持16个8位元素并行运算
- **精度范围**：8位到64位整数运算
- **流水线深度**：多级流水线（具体深度需查看RTL）
- **吞吐率**：每个时钟周期可接受新输入（在流水线满的情况下）

## 7. 验证重点

基于以上分析，验证应重点关注：

1. **计算正确性**：确保所有精度下的商和余数计算正确
2. **边界条件**：除零和溢出情况的正确处理
3. **向量化**：多元素并行运算的正确性和独立性
4. **协议时序**：握手协议和流水线控制的正确实现
5. **特殊情况**：各种边界值和特殊输入的处理

这些基础信息为后续的详细验证用例设计和实现提供了清晰的指导。